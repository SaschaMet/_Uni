---
title: "Übung 07"
author: "Sascha Metzger - 1910837830 - DSIA Algorithmik & Statistik, SS 2019"
date: '2019-01-01 (updated: `r Sys.Date()`)'
output:
  html_document:
    df_print: paged
urlcolor: cyan
---

Bitte um Beachtung der [Übungs-Policy](https://algo2-lab.netlify.com/%C3%BCbungs-policy.html) für genaue Anweisungen und einige Beurteilungsnotizen. Fehler bei der Einhaltung ergeben Punktabzug.

Die Competition Anweisungen findest du auf WebLearn.

Die Einreichung erfolgt unter: [Leaderboard](https://g4challenge.shinyapps.io/shiny-leaderboard/)

Dieses Template soll bei der Erstellung der Einreichung helfen.

Für die volle Punktzahl dokumentiere:

- deine EDA
- dein Training 
- deine Schritte
- deine Ergebnisse (Screenshot vom Online-Tool)
- Diskussion der Ergebnisse (Speed vs. Long Run) - Strategien gegen Overfitting...


```{r libraries, message = FALSE, warning = FALSE}
library(dplyr)
library(ISLR)
library(caret)
library(e1071)
library(tidyverse)
library(tidymodels)
library(readr)
library(factoextra)
library(ggfortify)
library(ggplot2)
library(GGally)
library(fpc)
library(car)
```
***

```{r}
set.seed(1910837830)
```


# Klassifikation [10 Punkte]

```{r, message = FALSE, warning = FALSE}
class_trn = read_csv("class-trn.csv")
class_tst = read_csv("class-tst.csv")
```

```{r}
#set train control for 5-fold Cross Validation:
ctrl <- trainControl(
        method = "repeatedcv", 
        number = 10,
        repeats = 5,
        )
```

```{r, message=F, warning=F}
# classification task
# place code here that trains the model used to submit your best result
# only supply code needed to train that model
class_rf <- train(y ~ ., 
                  data = class_trn, 
                  method = "rf", 
                  trControl = ctrl,
                  preProcess = c("center","scale"))
class_rf
plot(class_rf)
```

```{r}
# place code here that stores the test predictions that you submitted
class_pred = predict(class_rf, newdata = class_tst)
head(class_pred)
confusionMatrix(class_rf)
```
***

# Regression [10 Punkte]

```{r, message = FALSE, warning = FALSE}
reg_trn = read_csv("reg-trn.csv")
reg_tst = read_csv("reg-tst.csv")
```

```{r}
rmse = function(actual, predicted) {
  sqrt(mean((actual - predicted) ^ 2))
}
```

```{r}
head(reg_trn)
```

```{r, message = FALSE, warning = FALSE}
reg_lm <- lm(y ~ ., data = reg_trn)
reg_lm
```

```{r}
reg_pred = predict(reg_lm, newdata = reg_tst)
reg_tst$Y = reg_pred
reg_tst
tibble(Y=reg_pred) %>% write.csv("reg_pred.csv")
```

***

# Spam Filter [10 Punkte]

```{r, message = FALSE, warning = FALSE}
spam_trn = read_csv("spam-trn.csv")
spam_tst = read_csv("spam-tst.csv")
```

```{r}
glimpse(spam_trn)
head(spam_trn)
```

```{r}
score = function(actual, predicted) {
  1   * sum(predicted == "spam" & actual == "spam") +
  -25 * sum(predicted == "spam" & actual == "nonspam") +
  -1  * sum(predicted == "nonspam" & actual == "spam") +
  2   * sum(predicted == "nonspam" & actual == "nonspam")
}
```

```{r}
trctrl <- trainControl(method = "repeatedcv", number = 5)
svm <- train(type ~., data = spam_trn, 
                    method = "svmRadial", 
                    trControl = trctrl, 
                    preProcess = c("center", "scale"))

svm
```

```{r}
spam_pred = predict(svm, spam_tst)
spam_tst$Y = spam_pred
score(spam_tst, spam_pred)
```

***

# Abgabe

## Erstellung der Abgabe CSV-Datei

```{r}
spam_pred <- predict(svm, spam_tst)
spam_pred %>% write.csv("spam_pred.csv")
```


https://g4challenge.shinyapps.io/shiny-leaderboard/

