# format the baskets into transactions
transactions <- as(order_baskets$basket, "transactions")
summary(transactions)
itemFrequencyPlot(transactions, topN=20, type="relative", col=brewer.pal(8,'Pastel2'), main="Relative Item Frequency Plot")
# Mine the rules using the APRIORI algorithm
# Min Support is 0.005, confidence is 0.15.
# Support = Frequency of an itemset in all transactions
# Confidence: Number of Itemsets (e.g. A+B) contained in all transactions of item A.
itemsets <- apriori(transactions, parameter = list(supp = 0.005, conf = 0.15), control = list(verbose = FALSE))
itemsets <- sort(itemsets, by='confidence', decreasing = TRUE)
summary(itemsets)
plot(itemsets)
inspect(itemsets)
# next best offer for Organic Large Extra Fancy Fuji Apple
start <- Sys.time()
nbo <- apriori(transactions, parameter = list(supp=0.001, conf=0.2), appearance = list(lhs="Organic Large Extra Fancy Fuji Apple", default="rhs"))
end <- Sys.time() - start
inspect(head(nbo))
print(end)
# goup the products by product_id and add the amount as a column
max_ordered_products <- order_products %>% group_by(product_id) %>% count() %>% arrange(desc(n))
# merge the df with the products, aisles and departments
merged <- merge(products, max_ordered_products, by = "product_id")
merged_sorted <- merged %>% arrange(desc(n))
max_ordered_products <- order_products %>% group_by(product_id) %>% count() %>% arrange(desc(n))
top100_products <- merged %>% arrange(desc(n))
top100_products <- merged_sorted[1:100,]
top100_products_ids <- top100_products$product_id
order_products_top100 <- subset(order_products, product_id %in% top100_products_ids)
order_products_top100 <- order_products_top100[1:250000,]
# the add_to_cart_order column is now irrelevant
order_products_top100$add_to_cart_order <- NULL
# merge the dv with the orders df and add the ordered product_ids into one element
order_products_top100 <- order_products_top100 %>% group_by(order_id) %>% summarise(product_id = paste(product_id, collapse = ","))
order_products_top100 <- merge(order_products_top100, orders, by = "order_id")
# remove the eval_set column
order_products_top100$eval_set <- NULL
# because of NA values
order_products_top100 <- order_products_top100 %>% mutate(days_since_prior_order = if_else(is.na(days_since_prior_order), -1, days_since_prior_order))
# add an extra column if the product_id 24852 (Banana) was in the basket
order_products_top100 %<>% rowwise() %>% mutate(Banana = ifelse(grepl("24852", product_id, fixed=T), 1, 0))
# format it to a factor
order_products_top100$Banana <- as.factor(order_products_top100$Banana)
# wir müssen die product_id column umformatieren, da ein string nicht in einem nn verarbeitet werden kann. Hierfür summieren wir einfach die product_ids
order_products_top100 %<>% rowwise() %>% mutate(product_id = sum(sapply(c(unlist(strsplit(product_id, ","))), as.integer)))
str(order_products_top100)
# Um ein Rare-Class Problem zu verhindern, stellen wir uns einen Datensatz zusammen, welcher eine ausgewogene Menge an Orders enthält, die eine Banane beinhalten
order_products_top100_with_Banana <- order_products_top100 %>% filter(Banana == 1)
order_products_top100_without_Banana <- order_products_top100 %>% filter(Banana == 0)
# 50:50 split of orders with and without bananas
order_products_top100_without_Banana <- order_products_top100_without_Banana[1:nrow(order_products_top100_with_Banana),]
# combine the datasets
data_original <- rbind(order_products_top100_with_Banana, order_products_top100_without_Banana)
# shuffle the dataset
rows <- sample(nrow(data_original))
data <- data_original[rows, ]
str(data)
# source: https://datascienceplus.com/neuralnet-train-and-test-neural-networks-using-r/
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
# Split data
train_idx <- sample(nrow(data), 1/4 * nrow(data))
train <- data[train_idx, ]
test <- data[-train_idx, ]
nrow(test)
nrow(train)
nn <- neuralnet(Banana == 1 ~ .,
data = train,
hidden = c(7, 4, 2),
act.fct = "logistic",
linear.output = F,
lifesign = "full")
plot(nn)
# Compute predictions
pred <- predict(nn, test)
results <- data.frame(actual = test$Banana, prediction = ifelse(pred > 0.5, 1, 0))
attach(results)
cfm1 <- confusionMatrix(table(actual, prediction))
cfm1
# commbine the basket data with the order data
baskets_with_user <- merge(orders, order_baskets, by = "order_id")
baskets_with_user$basket_length <- lengths(baskets_with_user$basket)
head(baskets_with_user)
# create a new df with the user_id, order_dow, order_hour_of_day, days_since_prior_order and basket_length columns
customer_data <- baskets_with_user %>% select(user_id, order_id, order_dow, order_hour_of_day, days_since_prior_order, basket_length)
customer_data <- customer_data %>% mutate(days_since_prior_order = if_else(is.na(days_since_prior_order), -1, days_since_prior_order))
customer_data <- customer_data %>% mutate(days_since_prior_order = as.integer(days_since_prior_order))
head(customer_data)
# use kmeans to create three customer clusters form our customer_data df.
clusters <- kmeans(scale(customer_data[,2:5]), 3, nstart = 1)
customer_data$Cluster <- as.factor(clusters$cluster) # Attaching the results to customer_data to identify each customer's cluster
customer_data
KMeans_Results <- customer_data %>% group_by(Cluster) %>% summarise(
'Number of Users' = n(),
'days_since_prior_order' = round(mean(days_since_prior_order)),
'basket_length' = round(mean(basket_length)),
'order_dow' = round(mean(order_dow)),
'order_hour_of_day' = round(mean(order_hour_of_day))
)
head(KMeans_Results)
Cluster_size_visz <- ggplot(KMeans_Results, aes(Cluster, `Number of Users`)) +
geom_text(aes(label = `Number of Users`), vjust = -0.3) +
geom_bar(aes(fill=Cluster), stat='identity') +
ggtitle('Number of Users per Cluster') +
xlab("Cluster Number") +
theme_classic()
print(Cluster_size_visz)
# add the cluster-id to the dataset
customer_data_m <- customer_data %>% select(basket_length, Cluster, order_id)
data_with_cluster <- merge(data_original, customer_data_m, by = "order_id")
data_with_cluster$Cluster <- as.integer(data_with_cluster$Cluster)
head(data_with_cluster)
# Split data
train2 <- data_with_cluster[train_idx, ]
test2 <- data_with_cluster[-train_idx, ]
nn2 <- neuralnet(Banana == 1 ~ .,
data = train2,
hidden = c(7, 4, 2),
act.fct = "logistic",
linear.output = F,
lifesign = "full")
plot(nn2)
# Compute predictions
pred2 <- predict(nn2, test2)
results2 <- data.frame(actual = test2$Banana, prediction = ifelse(pred2 > 0.5, 1, 0))
attach(results2)
cfm2 <- confusionMatrix(table(actual, prediction))
cfm2
cfm1
print("--------------------------------------------")
print("--------------------------------------------")
print("--------------------------------------------")
cfm2
rad_grid = expand.grid(C = c(2 ^ (-2:3)), sigma  = c(2 ^ (-3:1)))
svm_radial <- train(Purchase ~ ., data = oj_trn,
method = "svmRadial",
trControl = trctrl,
preProcess = c("center", "scale"),
tuneGrid = rad_grid)
rs_accuracy <- 0.77943933
summary_results <- tribble(~model, ~method, ~accuracy,
"SVM linear", "svmLinear", 0.8186916,
"SVM polynomial", "scmLinear2", 0.8168224,
"SVM radial", "svmRadial", 0.8242991,
"Random Forest", "rf", rs_accuracy)
summary_results
rs_accuracy <- 0.8
summary_results <- tribble(~model, ~method, ~accuracy,
"SVM linear", "svmLinear", 0.8186916,
"SVM polynomial", "scmLinear2", 0.8168224,
"SVM radial", "svmRadial", 0.8242991,
"Random Forest", "rf", rs_accuracy)
summary_results
rf <- train(Purchase ~ ., data = oj_trn,
method = "rf",
trControl = trctrl,
preProcess = c("center", "scale"))
knitr::opts_chunk$set(fig.align = "center")
library(ISLR)
library(caret)
library(e1071)
library(tidyverse)
library(tidymodels)
library(readr)
library(factoextra)
library(ggfortify)
library(ggplot2)
library(GGally)
library(fpc)
uin = 1910837830
set.seed(uin)
glimpse(OJ)
oj_split = initial_split(OJ, p = 0.5)
oj_trn = oj_split %>% training()
oj_tst = oj_split %>% testing()
trctrl <- trainControl(method = "cv", number = 5)
cost_param <- (C = c(2 ^ (-5:5)))
svm <- train(Purchase ~., data = oj_trn,
method = "svmLinear",
trControl = trctrl,
cost = cost_param,
preProcess = c("center", "scale"))
svm_lin_pred <- predict(svm, oj_trn)
svm_lin_acc <- postResample(predict(svm, oj_tst), oj_tst$Purchase)
summary(svm)
svm_lin_acc
svm_poly_1 <- train(Purchase ~ ., data = oj_trn,
method = "svmLinear2",
trControl = trctrl,
preProcess = c("center", "scale"))
svm_poly_1_acc <- postResample(predict(svm_poly_1, oj_tst), oj_tst$Purchase)
summary(svm_poly_1)
svm_poly_1_acc
rad_grid = expand.grid(C = c(2 ^ (-2:3)), sigma  = c(2 ^ (-3:1)))
svm_radial <- train(Purchase ~ ., data = oj_trn,
method = "svmRadial",
trControl = trctrl,
preProcess = c("center", "scale"),
tuneGrid = rad_grid)
svm_radial_acc <- postResample(predict(svm_radial, oj_tst), oj_tst$Purchase)
summary(svm_radial)
svm_radial_acc
rf <- train(Purchase ~ ., data = oj_trn,
method = "rf",
trControl = trctrl,
preProcess = c("center", "scale"))
rf_acc <- postResample(predict(rf, oj_tst), oj_tst$Purchase)
summary(rf)
rf_acc$accuracy
rf_acc
rf <- train(Purchase ~ ., data = oj_trn,
method = "rf",
trControl = trctrl,
preProcess = c("center", "scale"))
rf_acc <- postResample(predict(rf, oj_tst), oj_tst$Purchase)
summary(rf)
rf_acc
rf_acc["Accuracy"]
summary_results <- tribble(~model, ~method, ~accuracy,
"SVM linear", "svmLinear", 0.8186916,
"SVM polynomial", "scmLinear2", 0.8168224,
"SVM radial", "svmRadial", 0.8242991,
"Random Forest", "rf", rf_acc["Accuracy"])
rf <- train(Purchase ~ ., data = oj_trn,
method = "rf",
trControl = trctrl,
preProcess = c("center", "scale"))
rf_acc <- postResample(predict(rf, oj_tst), oj_tst$Purchase)
summary(rf)
rf_acc
summary_results <- tribble(~model, ~method, ~accuracy,
"SVM linear", "svmLinear", 0.8168224,
"SVM polynomial", "scmLinear2", 0.8186916,
"SVM radial", "svmRadial", 0.7981308,
"Random Forest", "rf", 0.7906542)
summary_results
WSS <- numeric(15)
for(i in 1:15) {
WSS[i] <- kmeans(df, centers = i, nstart = 10)$tot.withinss
}
df <- read_csv("clust_data.csv")
head(df)
k <- 15
WSS <- numeric(k)
for(i in 1:k) {
WSS[i] <- kmeans(df, centers = i, nstart = 10)$tot.withinss
}
cbind(No.of.Cluters=1:k, WSS)
optimal_k <- plot(1:k, WSS, type="l", xlab = "No. of clusters", ylab = "Total WSS", main = "Scree Plot")
optimal_k
clusters <- kmeans(df, centers = 4, nstart = 10)
clusters$tot.withinss
clusters
clusters <- kmeans(df, centers = 4, nstart = 10)
clusters
clusters$tot.withinss
df
plotcluster(df[1:2], clusters$cluster)
df[1:2]
plotcluster(df[1:2], clusters$cluster)
cluster_pca <- prcomp(df[], center = TRUE, scale. = TRUE)
plot_cluster <- autoplot(cluster_pca, data = df)
cluster_pca1 <- fviz_cluster(clusters, data = df)
plot_cluster
biplot(cluster_pca)
cluster_pca1
cluster_pca1 <- fviz_cluster(clusters, data = df)
cluster_pca1
df1 <- USArrests %>% na.omit() %>% scale()
df1_unscaled <- df1 %>% unscale()
head(df1)
head(df1_unscaled)
hclust_single <- hclust(dist_matrix, method = "single")
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- hclust(dist_matrix, method = "single")
hclust_single_unscaled <- hclust(dist_matrix_unscaled, method = "single")
# plot the resulting hierarchical clusters
plot(hclust_single, cex = 0.6, hand = -1)
plot(hclust_single_unscaled, cex = 0.6, hand = -1)
#cut trees to 4 cluster
cut_single <- cutree(hclust_single, k = 4)
cut_single_unscaled <- cutree(hclust_single_unscaled, k = 4)
plot(cut_single)
plot(cut_single_unscaled)
hclust_average <- hclust(dist_matrix, method = "average")
hclust_average_unscaled <- hclust(dist_matrix_unscaled, method = "average")
plot(hclust_average, cex = 0.6, hand = -1)
plot(hclust_average_unscaled, cex = 0.6, hand = -1)
cut_average <- cutree(hclust_average, k = 4)
cut_average_unscaled <- cutree(hclust_average_unscaled, k = 4)
plot(cut_average)
plot(cut_average_unscaled)
hclust_mcquitty <- hclust(dist_matrix, method = "mcquitty")
hclust_mcquitty_unscaled <- hclust(dist_matrix_unscaled, method = "mcquitty")
plot(hclust_mcquitty, cex = 0.6, hand = -1)
plot(hclust_mcquitty_unscaled, cex = 0.6, hand = -1)
cut_mcquitty <- cutree(hclust_complete, k = 4)
hclust_complete <- hclust(dist_matrix, method = "complete")
hclust_complete_unscaled <- hclust(dist_matrix_unscaled, method = "complete")
plot(hclust_complete, cex = 0.6, hand = -1)
plot(hclust_complete_unscaled, cex = 0.6, hand = -1)
cut_complete <- cutree(hclust_complete, k = 4)
cut_complete_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_complete)
plot(cut_complete_unscaled)
hclust_mcquitty <- hclust(dist_matrix, method = "mcquitty")
hclust_mcquitty_unscaled <- hclust(dist_matrix_unscaled, method = "mcquitty")
plot(hclust_mcquitty, cex = 0.6, hand = -1)
plot(hclust_mcquitty_unscaled, cex = 0.6, hand = -1)
cut_mcquitty <- cutree(hclust_complete, k = 4)
cut_mcquitty_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_mcquitty)
plot(cut_mcquitty_unscaled)
hclust_complete1 <- hclust(dist_matrix1, method = "complete")
dist_matrix1 <- dist(df1, method = "canberra")
hclust_complete1 <- hclust(dist_matrix1, method = "complete")
cut_complete1 <- cutree(hclust_complete1, k = 4)
plot(cut_complete1)
plot(cut_complete)
dist_matrix1 <- dist(df1, method = "canberra")
hclust_complete1 <- hclust(dist_matrix1, method = "complete")
plot(hclust_complete)
plot(hclust_complete1, cex = 0.6, hand = -1)
dist_matrix1 <- dist(df1, method = "canberra")
hclust_complete1 <- hclust(dist_matrix1, method = "complete")
plot(hclust_complete)
plot(hclust_complete1, cex = 0.6, hand = -1)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- hclust(dist_matrix, method = "single")
hclust_single_unscaled <- hclust(dist_matrix_unscaled, method = "single")
# let's add some color:
labels_colors(hclust_single) <- 1:4
library(dendextend)
library(dendextend)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- hclust(dist_matrix, method = "single")
hclust_single_unscaled <- hclust(dist_matrix_unscaled, method = "single")
# let's add some color:
labels_colors(hclust_single) <- 1:4
library(dendextend)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- hclust(dist_matrix, method = "single")
hclust_single_unscaled <- hclust(dist_matrix_unscaled, method = "single")
# let's add some color:
labels_colors(hclust_single) <- 1:4
library(dendextend)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- as.dendrogram(hclust(dist_matrix, method = "single"))
hclust_single_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "single"))
# let's add some color:
labels_colors(hclust_single) <- 1:4
# Now each state has a color
labels_colors(hclust_single)
# plot the resulting hierarchical clusters
plot(hclust_single, cex = 0.6, hand = -1)
plot(hclust_single_unscaled, cex = 0.6, hand = -1)
#cut trees to 4 cluster
cut_single <- cutree(hclust_single, k = 4)
cut_single_unscaled <- cutree(hclust_single_unscaled, k = 4)
plot(cut_single)
plot(cut_single_unscaled)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- hclust(dist_matrix, method = "single")
hclust_single_unscaled <- hclust(dist_matrix_unscaled, method = "single")
# plot the resulting hierarchical clusters
plot(hclust_single, cex = 0.6, hand = -1)
plot(hclust_single_unscaled, cex = 0.6, hand = -1)
#cut trees to 4 cluster
cut_single <- cutree(hclust_single, k = 4)
cut_single_unscaled <- cutree(hclust_single_unscaled, k = 4)
plot(cut_single)
plot(cut_single_unscaled)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- as.dendrogram(hclust(dist_matrix, method = "single"))
hclust_single_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "single"))
labels_colors(hclust_single) <- 1:4
labels_colors(hclust_single_unscaled) <- 1:4
# plot the resulting hierarchical clusters
plot(hclust_single, cex = 0.6, hand = -1)
plot(hclust_single_unscaled, cex = 0.6, hand = -1)
#cut trees to 4 cluster
cut_single <- cutree(hclust_single, k = 4)
cut_single_unscaled <- cutree(hclust_single_unscaled, k = 4)
plot(cut_single)
plot(cut_single_unscaled)
hclust_average <- as.dendrogram(hclust(dist_matrix, method = "average"))
hclust_average_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "average"))
labels_colors(hclust_single) <- 1:4
labels_colors(hclust_single_unscaled) <- 1:4
plot(hclust_average, cex = 0.6, hand = -1)
plot(hclust_average_unscaled, cex = 0.6, hand = -1)
cut_average <- cutree(hclust_average, k = 4)
cut_average_unscaled <- cutree(hclust_average_unscaled, k = 4)
plot(cut_average)
plot(cut_average_unscaled)
hclust_average <- as.dendrogram(hclust(dist_matrix, method = "average"))
hclust_average_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "average"))
labels_colors(hclust_average) <- 1:4
labels_colors(hclust_average_unscaled) <- 1:4
plot(hclust_average, cex = 0.6, hand = -1)
plot(hclust_average_unscaled, cex = 0.6, hand = -1)
cut_average <- cutree(hclust_average, k = 4)
cut_average_unscaled <- cutree(hclust_average_unscaled, k = 4)
plot(cut_average)
plot(cut_average_unscaled)
hclust_complete <- as.dendrogram(hclust(dist_matrix, method = "complete"))
hclust_complete_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "complete"))
labels_colors(hclust_complete) <- 1:4
labels_colors(hclust_complete_unscaled) <- 1:4
plot(hclust_complete, cex = 0.6, hand = -1)
plot(hclust_complete_unscaled, cex = 0.6, hand = -1)
cut_complete <- cutree(hclust_complete, k = 4)
cut_complete_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_complete)
plot(cut_complete_unscaled)
hclust_mcquitty <- as.dendrogram(hclust(dist_matrix, method = "mcquitty"))
hclust_mcquitty_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "mcquitty"))
labels_colors(hclust_mcquitty) <- 1:4
labels_colors(hclust_mcquitty_unscaled) <- 1:4
plot(hclust_mcquitty, cex = 0.6, hand = -1)
plot(hclust_mcquitty_unscaled, cex = 0.6, hand = -1)
cut_mcquitty <- cutree(hclust_complete, k = 4)
cut_mcquitty_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_mcquitty)
plot(cut_mcquitty_unscaled)
dist_matrix1 <- dist(df1, method = "canberra")
hclust_complete1 <-as.dendrogram( hclust(dist_matrix1, method = "complete"))
labels_colors(hclust_complete1) <- 1:4
plot(hclust_complete)
plot(hclust_complete1, cex = 0.6, hand = -1)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- as.dendrogram(hclust(dist_matrix, method = "single"))
hclust_single_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "single"))
# labels_colors(hclust_single) <- 1:4
# labels_colors(hclust_single_unscaled) <- 1:4
hclust_single <- color_labels(hclust_single, k = 4)
# plot the resulting hierarchical clusters
plot(hclust_single, cex = 0.6, hand = -1)
plot(hclust_single_unscaled, cex = 0.6, hand = -1)
#cut trees to 4 cluster
cut_single <- cutree(hclust_single, k = 4)
cut_single_unscaled <- cutree(hclust_single_unscaled, k = 4)
plot(cut_single)
plot(cut_single_unscaled)
dist_matrix <- dist(df1, method = "euclidean")
dist_matrix_unscaled <- dist(df1_unscaled, method = "euclidean")
hclust_single <- as.dendrogram(hclust(dist_matrix, method = "single"))
hclust_single_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "single"))
hclust_single <- color_labels(hclust_single, k = 4)
hclust_single_unscaled <- color_labels(hclust_single_unscaled, k = 4)
# plot the resulting hierarchical clusters
plot(hclust_single, cex = 0.6, hand = -1)
plot(hclust_single_unscaled, cex = 0.6, hand = -1)
#cut trees to 4 cluster
cut_single <- cutree(hclust_single, k = 4)
cut_single_unscaled <- cutree(hclust_single_unscaled, k = 4)
plot(cut_single)
plot(cut_single_unscaled)
hclust_average <- as.dendrogram(hclust(dist_matrix, method = "average"))
hclust_average_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "average"))
hclust_average <- color_labels(hclust_average, k = 4)
hclust_average_unscaled <- color_labels(hclust_average_unscaled, k = 4)
plot(hclust_average, cex = 0.6, hand = -1)
plot(hclust_average_unscaled, cex = 0.6, hand = -1)
cut_average <- cutree(hclust_average, k = 4)
cut_average_unscaled <- cutree(hclust_average_unscaled, k = 4)
plot(cut_average)
plot(cut_average_unscaled)
hclust_complete <- as.dendrogram(hclust(dist_matrix, method = "complete"))
hclust_complete_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "complete"))
hclust_complete <- color_labels(hclust_complete, k = 4)
hclust_complete_unscaled <- color_labels(hclust_complete_unscaled, k = 4)
cut_complete <- cutree(hclust_complete, k = 4)
cut_complete_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_complete)
plot(cut_complete_unscaled)
hclust_complete <- as.dendrogram(hclust(dist_matrix, method = "complete"))
hclust_complete_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "complete"))
hclust_complete <- color_labels(hclust_complete, k = 4)
hclust_complete_unscaled <- color_labels(hclust_complete_unscaled, k = 4)
plot(hclust_complete, cex = 0.6, hand = -1)
plot(hclust_complete_unscaled, cex = 0.6, hand = -1)
cut_complete <- cutree(hclust_complete, k = 4)
cut_complete_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_complete)
plot(cut_complete_unscaled)
hclust_mcquitty <- as.dendrogram(hclust(dist_matrix, method = "mcquitty"))
hclust_mcquitty_unscaled <- as.dendrogram(hclust(dist_matrix_unscaled, method = "mcquitty"))
hclust_mcquitty <- color_labels(hclust_mcquitty, k = 4)
hclust_mcquitty_unscaled <- color_labels(hclust_mcquitty_unscaled, k = 4)
plot(hclust_mcquitty, cex = 0.6, hand = -1)
plot(hclust_mcquitty_unscaled, cex = 0.6, hand = -1)
cut_mcquitty <- cutree(hclust_complete, k = 4)
cut_mcquitty_unscaled <- cutree(hclust_complete_unscaled, k = 4)
plot(cut_mcquitty)
plot(cut_mcquitty_unscaled)
dist_matrix1 <- dist(df1, method = "canberra")
hclust_complete1 <-as.dendrogram( hclust(dist_matrix1, method = "complete"))
hclust_complete1 <- color_labels(hclust_complete1, k = 4)
plot(hclust_complete)
plot(hclust_complete1, cex = 0.6, hand = -1)
